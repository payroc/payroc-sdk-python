# This file was auto-generated by Fern from our API Definition.

import typing

from ...core.client_wrapper import AsyncClientWrapper, SyncClientWrapper
from ...core.request_options import RequestOptions
from ...types.single_use_token import SingleUseToken
from .raw_client import AsyncRawSingleUseTokensClient, RawSingleUseTokensClient
from .types.single_use_token_request_channel import SingleUseTokenRequestChannel
from .types.single_use_token_request_source import SingleUseTokenRequestSource

# this is used as the default value for optional parameters
OMIT = typing.cast(typing.Any, ...)


class SingleUseTokensClient:
    def __init__(self, *, client_wrapper: SyncClientWrapper):
        self._raw_client = RawSingleUseTokensClient(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> RawSingleUseTokensClient:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        RawSingleUseTokensClient
        """
        return self._raw_client

    def create(
        self,
        processing_terminal_id: str,
        *,
        idempotency_key: str,
        channel: SingleUseTokenRequestChannel,
        source: SingleUseTokenRequestSource,
        operator: typing.Optional[str] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> SingleUseToken:
        """
        Use this method to create a single-use token that represents a customer’s payment details.

        A single-use token expires after 30 minutes and merchants can use them only once.

        **Note:** To create a reusable permanent token, go to [Create Secure Token](https://docs.payroc.com/api/schema/tokenization/secure-tokens/create).

        In the request, send the customer’s payment details. If the request is successful, our gateway returns a token that you can use in a follow-on action, for example, [run a sale](https://docs.payroc.com/api/schema/card-payments/payments/create).

        Parameters
        ----------
        processing_terminal_id : str
            Unique identifier that our gateway assigned to the terminal.

        idempotency_key : str
            Unique identifier that you generate for each request. You must use the [UUID v4 format](https://www.rfc-editor.org/rfc/rfc4122) for the identifier. For more information about the idempotency key, go to [Idempotency](https://docs.payroc.com/api/idempotency).

        channel : SingleUseTokenRequestChannel
            Channel that the merchant used to receive the payment details.

        source : SingleUseTokenRequestSource
            Polymorphic object that contains the payment method to tokenize.

            The value of the type parameter determines which variant you should use:
            -    `ach` - Automated Clearing House (ACH) details
            -    `pad` - Pre-authorized debit (PAD) details
            -    `card` - Payment card details

        operator : typing.Optional[str]
            Operator who initiated the request.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        SingleUseToken
            Successful request. We created the single-use token.

        Examples
        --------
        from payroc import CardPayloadCardDetails_Raw, Device, Payroc
        from payroc.tokenization.single_use_tokens import (
            SingleUseTokenRequestSource_Card,
        )

        client = Payroc(
            api_key="YOUR_API_KEY",
        )
        client.tokenization.single_use_tokens.create(
            processing_terminal_id="1234001",
            idempotency_key="8e03978e-40d5-43e8-bc93-6894a57f9324",
            channel="web",
            operator="Jane",
            source=SingleUseTokenRequestSource_Card(
                card_details=CardPayloadCardDetails_Raw(
                    device=Device(
                        model="bbposChp",
                        serial_number="1850010868",
                    ),
                    raw_data="A1B2C3D4E5F67890ABCD1234567890ABCDEF1234567890ABCDEF1234567890ABCDEF",
                ),
            ),
        )
        """
        _response = self._raw_client.create(
            processing_terminal_id,
            idempotency_key=idempotency_key,
            channel=channel,
            source=source,
            operator=operator,
            request_options=request_options,
        )
        return _response.data


class AsyncSingleUseTokensClient:
    def __init__(self, *, client_wrapper: AsyncClientWrapper):
        self._raw_client = AsyncRawSingleUseTokensClient(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> AsyncRawSingleUseTokensClient:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        AsyncRawSingleUseTokensClient
        """
        return self._raw_client

    async def create(
        self,
        processing_terminal_id: str,
        *,
        idempotency_key: str,
        channel: SingleUseTokenRequestChannel,
        source: SingleUseTokenRequestSource,
        operator: typing.Optional[str] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> SingleUseToken:
        """
        Use this method to create a single-use token that represents a customer’s payment details.

        A single-use token expires after 30 minutes and merchants can use them only once.

        **Note:** To create a reusable permanent token, go to [Create Secure Token](https://docs.payroc.com/api/schema/tokenization/secure-tokens/create).

        In the request, send the customer’s payment details. If the request is successful, our gateway returns a token that you can use in a follow-on action, for example, [run a sale](https://docs.payroc.com/api/schema/card-payments/payments/create).

        Parameters
        ----------
        processing_terminal_id : str
            Unique identifier that our gateway assigned to the terminal.

        idempotency_key : str
            Unique identifier that you generate for each request. You must use the [UUID v4 format](https://www.rfc-editor.org/rfc/rfc4122) for the identifier. For more information about the idempotency key, go to [Idempotency](https://docs.payroc.com/api/idempotency).

        channel : SingleUseTokenRequestChannel
            Channel that the merchant used to receive the payment details.

        source : SingleUseTokenRequestSource
            Polymorphic object that contains the payment method to tokenize.

            The value of the type parameter determines which variant you should use:
            -    `ach` - Automated Clearing House (ACH) details
            -    `pad` - Pre-authorized debit (PAD) details
            -    `card` - Payment card details

        operator : typing.Optional[str]
            Operator who initiated the request.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        SingleUseToken
            Successful request. We created the single-use token.

        Examples
        --------
        import asyncio

        from payroc import AsyncPayroc, CardPayloadCardDetails_Raw, Device
        from payroc.tokenization.single_use_tokens import (
            SingleUseTokenRequestSource_Card,
        )

        client = AsyncPayroc(
            api_key="YOUR_API_KEY",
        )


        async def main() -> None:
            await client.tokenization.single_use_tokens.create(
                processing_terminal_id="1234001",
                idempotency_key="8e03978e-40d5-43e8-bc93-6894a57f9324",
                channel="web",
                operator="Jane",
                source=SingleUseTokenRequestSource_Card(
                    card_details=CardPayloadCardDetails_Raw(
                        device=Device(
                            model="bbposChp",
                            serial_number="1850010868",
                        ),
                        raw_data="A1B2C3D4E5F67890ABCD1234567890ABCDEF1234567890ABCDEF1234567890ABCDEF",
                    ),
                ),
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.create(
            processing_terminal_id,
            idempotency_key=idempotency_key,
            channel=channel,
            source=source,
            operator=operator,
            request_options=request_options,
        )
        return _response.data
