# This file was auto-generated by Fern from our API Definition.

from typing import Any, Dict, Optional


class ApiError(Exception):
    headers: Optional[Dict[str, str]]
    status_code: Optional[int]
    body: Any

    def __init__(
        self,
        *,
        headers: Optional[Dict[str, str]] = None,
        status_code: Optional[int] = None,
        body: Any = None,
    ) -> None:
        self.headers = headers
        self.status_code = status_code
        self.body = body

    def __str__(self) -> str:
        # Redact sensitive headers to prevent credential exposure in logs and error messages
        safe_headers = self._redact_sensitive_headers(self.headers) if self.headers else None
        return f"headers: {safe_headers}, status_code: {self.status_code}, body: {self.body}"

    @staticmethod
    def _redact_sensitive_headers(headers: Dict[str, str]) -> Dict[str, str]:
        """
        Redact sensitive header values to prevent credential exposure.
        
        This method protects against accidental logging or display of:
        - Authorization tokens (Bearer tokens)
        - API keys
        - Authentication credentials
        """
        # Define sensitive header keys (case-insensitive)
        sensitive_keys = {
            'authorization',
            'x-api-key',
            'api-key',
            'apikey',
            'token',
            'auth-token',
            'access-token',
            'client-secret',
            'secret',
        }
        
        safe_headers = {}
        for key, value in headers.items():
            if key.lower() in sensitive_keys:
                safe_headers[key] = '[REDACTED]'
            else:
                safe_headers[key] = value
        return safe_headers
