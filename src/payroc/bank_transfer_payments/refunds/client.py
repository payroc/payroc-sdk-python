# This file was auto-generated by Fern from our API Definition.

import datetime as dt
import typing

from ...core.client_wrapper import AsyncClientWrapper, SyncClientWrapper
from ...core.custom_pagination import AsyncPayrocPager, SyncPayrocPager
from ...core.request_options import RequestOptions
from ...types.bank_transfer_customer import BankTransferCustomer
from ...types.bank_transfer_payment import BankTransferPayment
from ...types.bank_transfer_refund import BankTransferRefund
from ...types.bank_transfer_refund_order import BankTransferRefundOrder
from ...types.bank_transfer_refund_paginated_list import BankTransferRefundPaginatedList
from ...types.custom_field import CustomField
from .raw_client import AsyncRawRefundsClient, RawRefundsClient
from .types.bank_transfer_unreferenced_refund_refund_method import BankTransferUnreferencedRefundRefundMethod
from .types.list_refunds_request_settlement_state import ListRefundsRequestSettlementState
from .types.list_refunds_request_status_item import ListRefundsRequestStatusItem
from .types.list_refunds_request_type_item import ListRefundsRequestTypeItem

# this is used as the default value for optional parameters
OMIT = typing.cast(typing.Any, ...)


class RefundsClient:
    def __init__(self, *, client_wrapper: SyncClientWrapper):
        self._raw_client = RawRefundsClient(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> RawRefundsClient:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        RawRefundsClient
        """
        return self._raw_client

    def reverse_payment(
        self, payment_id: str, *, idempotency_key: str, request_options: typing.Optional[RequestOptions] = None
    ) -> BankTransferPayment:
        """
        Use this method to cancel a bank transfer payment in an open batch. This is also known as voiding a payment.

        To cancel a bank transfer payment, you need its paymentId. Our gateway returned the paymentId in the response of the [Create Payment](https://docs.payroc.com/api/schema/bank-transfer-payments/payments/create) method.

        **Note:** If you don't have the paymentId, use our [List Payments](https://docs.payroc.com/api/schema/bank-transfer-payments/payments/list) method to search for the bank transfer payment.

        If your request is successful, our gateway removes the bank transfer payment from the merchant’s open batch and no funds are taken from the customer's bank account.

        Parameters
        ----------
        payment_id : str
            Unique identifier that our gateway assigned to the payment.

        idempotency_key : str
            Unique identifier that you generate for each request. You must use the [UUID v4 format](https://www.rfc-editor.org/rfc/rfc4122) for the identifier. For more information about the idempotency key, go to [Idempotency](https://docs.payroc.com/api/idempotency).

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        BankTransferPayment
            Successful request. We voided the payment.

        Examples
        --------
        from payroc import Payroc

        client = Payroc(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )
        client.bank_transfer_payments.refunds.reverse_payment(
            payment_id="M2MJOG6O2Y",
            idempotency_key="8e03978e-40d5-43e8-bc93-6894a57f9324",
        )
        """
        _response = self._raw_client.reverse_payment(
            payment_id, idempotency_key=idempotency_key, request_options=request_options
        )
        return _response.data

    def refund(
        self,
        payment_id: str,
        *,
        idempotency_key: str,
        amount: int,
        description: str,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> BankTransferPayment:
        """
        Use this method to refund a bank transfer payment that is in a closed batch.

        To refund a bank transfer payment, you need its paymentId. Our gateway returned the paymentId in the response of the [Create Payment](https://docs.payroc.com/api/schema/bank-transfer-payments/payments/create) method.

        **Note:** If you don’t have the paymentId, use our [List Payments](https://docs.payroc.com/api/schema/bank-transfer-payments/payments/list) method to search for the bank transfer payment.

        If your refund is successful, our gateway returns the payment amount to the customer's account.

        **Things to consider**
        - If the merchant refunds a bank transfer payment that is in an open batch, our gateway reverses the bank transfer payment.
        - Some merchants can run unreferenced refunds, which means that they don’t need a paymentId to return an amount to a customer. For more information about how to run an unreferenced refund, go to [Create Refund](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/create).

        Parameters
        ----------
        payment_id : str
            Unique identifier that our gateway assigned to the payment.

        idempotency_key : str
            Unique identifier that you generate for each request. You must use the [UUID v4 format](https://www.rfc-editor.org/rfc/rfc4122) for the identifier. For more information about the idempotency key, go to [Idempotency](https://docs.payroc.com/api/idempotency).

        amount : int
            Total amount of the refund. The value is in the currency's lowest denomination, for example, cents.

        description : str
            Description of the refund.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        BankTransferPayment
            Successful request. We refunded the payment.

        Examples
        --------
        from payroc import Payroc

        client = Payroc(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )
        client.bank_transfer_payments.refunds.refund(
            payment_id="M2MJOG6O2Y",
            idempotency_key="8e03978e-40d5-43e8-bc93-6894a57f9324",
            amount=4999,
            description="amount to refund",
        )
        """
        _response = self._raw_client.refund(
            payment_id,
            idempotency_key=idempotency_key,
            amount=amount,
            description=description,
            request_options=request_options,
        )
        return _response.data

    def list(
        self,
        *,
        processing_terminal_id: str,
        order_id: typing.Optional[str] = None,
        name_on_account: typing.Optional[str] = None,
        last_4: typing.Optional[str] = None,
        type: typing.Optional[
            typing.Union[ListRefundsRequestTypeItem, typing.Sequence[ListRefundsRequestTypeItem]]
        ] = None,
        status: typing.Optional[
            typing.Union[ListRefundsRequestStatusItem, typing.Sequence[ListRefundsRequestStatusItem]]
        ] = None,
        date_from: typing.Optional[dt.datetime] = None,
        date_to: typing.Optional[dt.datetime] = None,
        settlement_state: typing.Optional[ListRefundsRequestSettlementState] = None,
        settlement_date: typing.Optional[dt.date] = None,
        before: typing.Optional[str] = None,
        after: typing.Optional[str] = None,
        limit: typing.Optional[int] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> SyncPayrocPager[BankTransferRefund, BankTransferRefundPaginatedList]:
        """
        Use this method to return a [paginated](https://docs.payroc.com/api/pagination) list of bank transfer refunds.

        **Note:** If you want to view the details of a specific refund and you have its refundId, use our [Retrieve Refund](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/retrieve) method.

        Use query parameters to filter the list of results that we return, for example, to search for refunds for a customer, an orderId, or a date range.

        Our gateway returns the following information about each refund in the list:

        -    Order details, including the refund amount and when it was processed.
        -    Bank account details, including the customer’s name and account number.

        For referenced refunds, our gateway also returns details about the payment that the refund is linked to.

        Parameters
        ----------
        processing_terminal_id : str
            Filter results by the unique identifier that we assigned to the terminal.

        order_id : typing.Optional[str]
            Filter results by the order ID of the refund.

        name_on_account : typing.Optional[str]
            Filter results by the accountholder's name.

        last_4 : typing.Optional[str]
            Filter results by the last four digits of the account number.

        type : typing.Optional[typing.Union[ListRefundsRequestTypeItem, typing.Sequence[ListRefundsRequestTypeItem]]]
            Filter results by transaction type.

        status : typing.Optional[typing.Union[ListRefundsRequestStatusItem, typing.Sequence[ListRefundsRequestStatusItem]]]
            Filter results by the status of the refund.

        date_from : typing.Optional[dt.datetime]
            Filter results by refunds that the merchant ran after a specific date. The value follows the [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) standard.

        date_to : typing.Optional[dt.datetime]
            Filter results by refunds that the merchant ran before a specific date. The value follows the [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) standard.

        settlement_state : typing.Optional[ListRefundsRequestSettlementState]
            Filter results by the settlement status.

        settlement_date : typing.Optional[dt.date]
            Filter results by the settlement date. Send a value in **YYYY-MM-DD** format.

        before : typing.Optional[str]
            Return the previous page of results before the value that you specify.

            You can’t send the before parameter in the same request as the after parameter.

        after : typing.Optional[str]
            Return the next page of results after the value that you specify.

            You can’t send the after parameter in the same request as the before parameter.

        limit : typing.Optional[int]
            Limit the maximum number of results that we return for each page.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        SyncPayrocPager[BankTransferRefund, BankTransferRefundPaginatedList]
            Successful request. Returns a list of refund transactions.

        Examples
        --------
        import datetime

        from payroc import Payroc

        client = Payroc(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )
        response = client.bank_transfer_payments.refunds.list(
            processing_terminal_id="1234001",
            order_id="OrderRef6543",
            name_on_account="Sarah%20Hazel%20Hopper",
            last_4="7062",
            date_from=datetime.datetime.fromisoformat(
                "2024-07-01 00:00:00+00:00",
            ),
            date_to=datetime.datetime.fromisoformat(
                "2024-07-31 23:59:59+00:00",
            ),
            settlement_state="settled",
            settlement_date=datetime.date.fromisoformat(
                "2024-07-15",
            ),
            before="2571",
            after="8516",
            limit=1,
        )
        for item in response:
            yield item
        # alternatively, you can paginate page-by-page
        for page in response.iter_pages():
            yield page
        """
        return self._raw_client.list(
            processing_terminal_id=processing_terminal_id,
            order_id=order_id,
            name_on_account=name_on_account,
            last_4=last_4,
            type=type,
            status=status,
            date_from=date_from,
            date_to=date_to,
            settlement_state=settlement_state,
            settlement_date=settlement_date,
            before=before,
            after=after,
            limit=limit,
            request_options=request_options,
        )

    def create(
        self,
        *,
        idempotency_key: str,
        processing_terminal_id: str,
        order: BankTransferRefundOrder,
        refund_method: BankTransferUnreferencedRefundRefundMethod,
        customer: typing.Optional[BankTransferCustomer] = OMIT,
        custom_fields: typing.Optional[typing.Sequence[CustomField]] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> BankTransferRefund:
        """
        Use this method to create an unreferenced refund. An unreferenced refund is a refund that isn’t linked to a bank transfer payment.

        **Note:** If you have the paymentId of the payment you want to refund, use our [Refund Payment](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/refund) method. If you use our Refund Payment method, our gateway sends the refund amount to the customer’s original payment method and links the refund to the payment.

        In the request, you must provide the customer’s payment method and information about the order including the refund amount.

        In the response, our gateway returns information about the refund and a refundId, which you need for the following methods:

        -    [Retrieve refund](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/retrieve) – View the details of the refund.
        -    [Reverse refund](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/reverse-refund) – Cancel the refund if it’s in an open batch.

        Parameters
        ----------
        idempotency_key : str
            Unique identifier that you generate for each request. You must use the [UUID v4 format](https://www.rfc-editor.org/rfc/rfc4122) for the identifier. For more information about the idempotency key, go to [Idempotency](https://docs.payroc.com/api/idempotency).

        processing_terminal_id : str
            Unique identifier that we assigned to the terminal.

        order : BankTransferRefundOrder

        refund_method : BankTransferUnreferencedRefundRefundMethod
            Object that contains information about how the merchant refunds the customer.

        customer : typing.Optional[BankTransferCustomer]

        custom_fields : typing.Optional[typing.Sequence[CustomField]]
            Array of customField objects.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        BankTransferRefund
            Successful request. We sent the refund to the customer's bank account.

        Examples
        --------
        from payroc import (
            BankTransferCustomer,
            BankTransferRefundOrder,
            ContactMethod_Email,
            CustomField,
            Payroc,
        )
        from payroc.bank_transfer_payments.refunds import (
            BankTransferUnreferencedRefundRefundMethod_Ach,
        )

        client = Payroc(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )
        client.bank_transfer_payments.refunds.create(
            idempotency_key="8e03978e-40d5-43e8-bc93-6894a57f9324",
            processing_terminal_id="1234001",
            order=BankTransferRefundOrder(
                order_id="OrderRef6543",
                description="Refund for order OrderRef6543",
                amount=4999,
                currency="USD",
            ),
            customer=BankTransferCustomer(
                notification_language="en",
                contact_methods=[
                    ContactMethod_Email(
                        value="jane.doe@example.com",
                    )
                ],
            ),
            refund_method=BankTransferUnreferencedRefundRefundMethod_Ach(
                name_on_account="Shara Hazel Hopper",
                account_number="1234567890",
                routing_number="123456789",
            ),
            custom_fields=[
                CustomField(
                    name="yourCustomField",
                    value="abc123",
                )
            ],
        )
        """
        _response = self._raw_client.create(
            idempotency_key=idempotency_key,
            processing_terminal_id=processing_terminal_id,
            order=order,
            refund_method=refund_method,
            customer=customer,
            custom_fields=custom_fields,
            request_options=request_options,
        )
        return _response.data

    def retrieve(
        self, refund_id: str, *, request_options: typing.Optional[RequestOptions] = None
    ) -> BankTransferRefund:
        """
        Use this method to retrieve information about a refund.

        To retrieve a refund, you need its refundId. Our gateway returned the refundId in the response of the [Refund Payment](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/refund) method or the [Create Refund](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/create) method.

        **Note:** If you don’t have the refundId, use our [List Refunds](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/list) method to search for the refund.

        Our gateway returns the following information about the refund:

        - Order details, including the refund amount and when it was processed.
        - Bank account details, including the customer’s name and account number.

        If the refund is a referenced refund, our gateway also returns details about the payment that the refund is linked to.

        Parameters
        ----------
        refund_id : str
            Unique identifier that our gateway assigned to the refund.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        BankTransferRefund
            Successful request. Returns the specific refund.

        Examples
        --------
        from payroc import Payroc

        client = Payroc(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )
        client.bank_transfer_payments.refunds.retrieve(
            refund_id="CD3HN88U9F",
        )
        """
        _response = self._raw_client.retrieve(refund_id, request_options=request_options)
        return _response.data

    def reverse_refund(
        self, refund_id: str, *, idempotency_key: str, request_options: typing.Optional[RequestOptions] = None
    ) -> BankTransferRefund:
        """
        Use this method to cancel a bank transfer refund in an open batch.

        To cancel a refund, you need its refundId. Our gateway returned the refundId in the response of the [Refund Payment](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/refund) or [Create Refund](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/create) method.

        **Note:** If you don’t have the refundId, use our [List Refunds](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/list) method to search for the refund.

        If your request is successful, the gateway removes the refund from the merchant’s open batch, and no funds are returned to the cardholder’s account.

        Parameters
        ----------
        refund_id : str
            Unique identifier that our gateway assigned to the refund.

        idempotency_key : str
            Unique identifier that you generate for each request. You must use the [UUID v4 format](https://www.rfc-editor.org/rfc/rfc4122) for the identifier. For more information about the idempotency key, go to [Idempotency](https://docs.payroc.com/api/idempotency).

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        BankTransferRefund
            Successful request. We reversed the refund transaction.

        Examples
        --------
        from payroc import Payroc

        client = Payroc(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )
        client.bank_transfer_payments.refunds.reverse_refund(
            refund_id="CD3HN88U9F",
            idempotency_key="8e03978e-40d5-43e8-bc93-6894a57f9324",
        )
        """
        _response = self._raw_client.reverse_refund(
            refund_id, idempotency_key=idempotency_key, request_options=request_options
        )
        return _response.data


class AsyncRefundsClient:
    def __init__(self, *, client_wrapper: AsyncClientWrapper):
        self._raw_client = AsyncRawRefundsClient(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> AsyncRawRefundsClient:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        AsyncRawRefundsClient
        """
        return self._raw_client

    async def reverse_payment(
        self, payment_id: str, *, idempotency_key: str, request_options: typing.Optional[RequestOptions] = None
    ) -> BankTransferPayment:
        """
        Use this method to cancel a bank transfer payment in an open batch. This is also known as voiding a payment.

        To cancel a bank transfer payment, you need its paymentId. Our gateway returned the paymentId in the response of the [Create Payment](https://docs.payroc.com/api/schema/bank-transfer-payments/payments/create) method.

        **Note:** If you don't have the paymentId, use our [List Payments](https://docs.payroc.com/api/schema/bank-transfer-payments/payments/list) method to search for the bank transfer payment.

        If your request is successful, our gateway removes the bank transfer payment from the merchant’s open batch and no funds are taken from the customer's bank account.

        Parameters
        ----------
        payment_id : str
            Unique identifier that our gateway assigned to the payment.

        idempotency_key : str
            Unique identifier that you generate for each request. You must use the [UUID v4 format](https://www.rfc-editor.org/rfc/rfc4122) for the identifier. For more information about the idempotency key, go to [Idempotency](https://docs.payroc.com/api/idempotency).

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        BankTransferPayment
            Successful request. We voided the payment.

        Examples
        --------
        import asyncio

        from payroc import AsyncPayroc

        client = AsyncPayroc(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )


        async def main() -> None:
            await client.bank_transfer_payments.refunds.reverse_payment(
                payment_id="M2MJOG6O2Y",
                idempotency_key="8e03978e-40d5-43e8-bc93-6894a57f9324",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.reverse_payment(
            payment_id, idempotency_key=idempotency_key, request_options=request_options
        )
        return _response.data

    async def refund(
        self,
        payment_id: str,
        *,
        idempotency_key: str,
        amount: int,
        description: str,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> BankTransferPayment:
        """
        Use this method to refund a bank transfer payment that is in a closed batch.

        To refund a bank transfer payment, you need its paymentId. Our gateway returned the paymentId in the response of the [Create Payment](https://docs.payroc.com/api/schema/bank-transfer-payments/payments/create) method.

        **Note:** If you don’t have the paymentId, use our [List Payments](https://docs.payroc.com/api/schema/bank-transfer-payments/payments/list) method to search for the bank transfer payment.

        If your refund is successful, our gateway returns the payment amount to the customer's account.

        **Things to consider**
        - If the merchant refunds a bank transfer payment that is in an open batch, our gateway reverses the bank transfer payment.
        - Some merchants can run unreferenced refunds, which means that they don’t need a paymentId to return an amount to a customer. For more information about how to run an unreferenced refund, go to [Create Refund](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/create).

        Parameters
        ----------
        payment_id : str
            Unique identifier that our gateway assigned to the payment.

        idempotency_key : str
            Unique identifier that you generate for each request. You must use the [UUID v4 format](https://www.rfc-editor.org/rfc/rfc4122) for the identifier. For more information about the idempotency key, go to [Idempotency](https://docs.payroc.com/api/idempotency).

        amount : int
            Total amount of the refund. The value is in the currency's lowest denomination, for example, cents.

        description : str
            Description of the refund.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        BankTransferPayment
            Successful request. We refunded the payment.

        Examples
        --------
        import asyncio

        from payroc import AsyncPayroc

        client = AsyncPayroc(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )


        async def main() -> None:
            await client.bank_transfer_payments.refunds.refund(
                payment_id="M2MJOG6O2Y",
                idempotency_key="8e03978e-40d5-43e8-bc93-6894a57f9324",
                amount=4999,
                description="amount to refund",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.refund(
            payment_id,
            idempotency_key=idempotency_key,
            amount=amount,
            description=description,
            request_options=request_options,
        )
        return _response.data

    async def list(
        self,
        *,
        processing_terminal_id: str,
        order_id: typing.Optional[str] = None,
        name_on_account: typing.Optional[str] = None,
        last_4: typing.Optional[str] = None,
        type: typing.Optional[
            typing.Union[ListRefundsRequestTypeItem, typing.Sequence[ListRefundsRequestTypeItem]]
        ] = None,
        status: typing.Optional[
            typing.Union[ListRefundsRequestStatusItem, typing.Sequence[ListRefundsRequestStatusItem]]
        ] = None,
        date_from: typing.Optional[dt.datetime] = None,
        date_to: typing.Optional[dt.datetime] = None,
        settlement_state: typing.Optional[ListRefundsRequestSettlementState] = None,
        settlement_date: typing.Optional[dt.date] = None,
        before: typing.Optional[str] = None,
        after: typing.Optional[str] = None,
        limit: typing.Optional[int] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> AsyncPayrocPager[BankTransferRefund, BankTransferRefundPaginatedList]:
        """
        Use this method to return a [paginated](https://docs.payroc.com/api/pagination) list of bank transfer refunds.

        **Note:** If you want to view the details of a specific refund and you have its refundId, use our [Retrieve Refund](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/retrieve) method.

        Use query parameters to filter the list of results that we return, for example, to search for refunds for a customer, an orderId, or a date range.

        Our gateway returns the following information about each refund in the list:

        -    Order details, including the refund amount and when it was processed.
        -    Bank account details, including the customer’s name and account number.

        For referenced refunds, our gateway also returns details about the payment that the refund is linked to.

        Parameters
        ----------
        processing_terminal_id : str
            Filter results by the unique identifier that we assigned to the terminal.

        order_id : typing.Optional[str]
            Filter results by the order ID of the refund.

        name_on_account : typing.Optional[str]
            Filter results by the accountholder's name.

        last_4 : typing.Optional[str]
            Filter results by the last four digits of the account number.

        type : typing.Optional[typing.Union[ListRefundsRequestTypeItem, typing.Sequence[ListRefundsRequestTypeItem]]]
            Filter results by transaction type.

        status : typing.Optional[typing.Union[ListRefundsRequestStatusItem, typing.Sequence[ListRefundsRequestStatusItem]]]
            Filter results by the status of the refund.

        date_from : typing.Optional[dt.datetime]
            Filter results by refunds that the merchant ran after a specific date. The value follows the [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) standard.

        date_to : typing.Optional[dt.datetime]
            Filter results by refunds that the merchant ran before a specific date. The value follows the [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) standard.

        settlement_state : typing.Optional[ListRefundsRequestSettlementState]
            Filter results by the settlement status.

        settlement_date : typing.Optional[dt.date]
            Filter results by the settlement date. Send a value in **YYYY-MM-DD** format.

        before : typing.Optional[str]
            Return the previous page of results before the value that you specify.

            You can’t send the before parameter in the same request as the after parameter.

        after : typing.Optional[str]
            Return the next page of results after the value that you specify.

            You can’t send the after parameter in the same request as the before parameter.

        limit : typing.Optional[int]
            Limit the maximum number of results that we return for each page.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        AsyncPayrocPager[BankTransferRefund, BankTransferRefundPaginatedList]
            Successful request. Returns a list of refund transactions.

        Examples
        --------
        import asyncio
        import datetime

        from payroc import AsyncPayroc

        client = AsyncPayroc(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )


        async def main() -> None:
            response = await client.bank_transfer_payments.refunds.list(
                processing_terminal_id="1234001",
                order_id="OrderRef6543",
                name_on_account="Sarah%20Hazel%20Hopper",
                last_4="7062",
                date_from=datetime.datetime.fromisoformat(
                    "2024-07-01 00:00:00+00:00",
                ),
                date_to=datetime.datetime.fromisoformat(
                    "2024-07-31 23:59:59+00:00",
                ),
                settlement_state="settled",
                settlement_date=datetime.date.fromisoformat(
                    "2024-07-15",
                ),
                before="2571",
                after="8516",
                limit=1,
            )
            async for item in response:
                yield item

            # alternatively, you can paginate page-by-page
            async for page in response.iter_pages():
                yield page


        asyncio.run(main())
        """
        return await self._raw_client.list(
            processing_terminal_id=processing_terminal_id,
            order_id=order_id,
            name_on_account=name_on_account,
            last_4=last_4,
            type=type,
            status=status,
            date_from=date_from,
            date_to=date_to,
            settlement_state=settlement_state,
            settlement_date=settlement_date,
            before=before,
            after=after,
            limit=limit,
            request_options=request_options,
        )

    async def create(
        self,
        *,
        idempotency_key: str,
        processing_terminal_id: str,
        order: BankTransferRefundOrder,
        refund_method: BankTransferUnreferencedRefundRefundMethod,
        customer: typing.Optional[BankTransferCustomer] = OMIT,
        custom_fields: typing.Optional[typing.Sequence[CustomField]] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> BankTransferRefund:
        """
        Use this method to create an unreferenced refund. An unreferenced refund is a refund that isn’t linked to a bank transfer payment.

        **Note:** If you have the paymentId of the payment you want to refund, use our [Refund Payment](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/refund) method. If you use our Refund Payment method, our gateway sends the refund amount to the customer’s original payment method and links the refund to the payment.

        In the request, you must provide the customer’s payment method and information about the order including the refund amount.

        In the response, our gateway returns information about the refund and a refundId, which you need for the following methods:

        -    [Retrieve refund](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/retrieve) – View the details of the refund.
        -    [Reverse refund](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/reverse-refund) – Cancel the refund if it’s in an open batch.

        Parameters
        ----------
        idempotency_key : str
            Unique identifier that you generate for each request. You must use the [UUID v4 format](https://www.rfc-editor.org/rfc/rfc4122) for the identifier. For more information about the idempotency key, go to [Idempotency](https://docs.payroc.com/api/idempotency).

        processing_terminal_id : str
            Unique identifier that we assigned to the terminal.

        order : BankTransferRefundOrder

        refund_method : BankTransferUnreferencedRefundRefundMethod
            Object that contains information about how the merchant refunds the customer.

        customer : typing.Optional[BankTransferCustomer]

        custom_fields : typing.Optional[typing.Sequence[CustomField]]
            Array of customField objects.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        BankTransferRefund
            Successful request. We sent the refund to the customer's bank account.

        Examples
        --------
        import asyncio

        from payroc import (
            AsyncPayroc,
            BankTransferCustomer,
            BankTransferRefundOrder,
            ContactMethod_Email,
            CustomField,
        )
        from payroc.bank_transfer_payments.refunds import (
            BankTransferUnreferencedRefundRefundMethod_Ach,
        )

        client = AsyncPayroc(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )


        async def main() -> None:
            await client.bank_transfer_payments.refunds.create(
                idempotency_key="8e03978e-40d5-43e8-bc93-6894a57f9324",
                processing_terminal_id="1234001",
                order=BankTransferRefundOrder(
                    order_id="OrderRef6543",
                    description="Refund for order OrderRef6543",
                    amount=4999,
                    currency="USD",
                ),
                customer=BankTransferCustomer(
                    notification_language="en",
                    contact_methods=[
                        ContactMethod_Email(
                            value="jane.doe@example.com",
                        )
                    ],
                ),
                refund_method=BankTransferUnreferencedRefundRefundMethod_Ach(
                    name_on_account="Shara Hazel Hopper",
                    account_number="1234567890",
                    routing_number="123456789",
                ),
                custom_fields=[
                    CustomField(
                        name="yourCustomField",
                        value="abc123",
                    )
                ],
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.create(
            idempotency_key=idempotency_key,
            processing_terminal_id=processing_terminal_id,
            order=order,
            refund_method=refund_method,
            customer=customer,
            custom_fields=custom_fields,
            request_options=request_options,
        )
        return _response.data

    async def retrieve(
        self, refund_id: str, *, request_options: typing.Optional[RequestOptions] = None
    ) -> BankTransferRefund:
        """
        Use this method to retrieve information about a refund.

        To retrieve a refund, you need its refundId. Our gateway returned the refundId in the response of the [Refund Payment](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/refund) method or the [Create Refund](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/create) method.

        **Note:** If you don’t have the refundId, use our [List Refunds](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/list) method to search for the refund.

        Our gateway returns the following information about the refund:

        - Order details, including the refund amount and when it was processed.
        - Bank account details, including the customer’s name and account number.

        If the refund is a referenced refund, our gateway also returns details about the payment that the refund is linked to.

        Parameters
        ----------
        refund_id : str
            Unique identifier that our gateway assigned to the refund.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        BankTransferRefund
            Successful request. Returns the specific refund.

        Examples
        --------
        import asyncio

        from payroc import AsyncPayroc

        client = AsyncPayroc(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )


        async def main() -> None:
            await client.bank_transfer_payments.refunds.retrieve(
                refund_id="CD3HN88U9F",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.retrieve(refund_id, request_options=request_options)
        return _response.data

    async def reverse_refund(
        self, refund_id: str, *, idempotency_key: str, request_options: typing.Optional[RequestOptions] = None
    ) -> BankTransferRefund:
        """
        Use this method to cancel a bank transfer refund in an open batch.

        To cancel a refund, you need its refundId. Our gateway returned the refundId in the response of the [Refund Payment](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/refund) or [Create Refund](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/create) method.

        **Note:** If you don’t have the refundId, use our [List Refunds](https://docs.payroc.com/api/schema/bank-transfer-payments/refunds/list) method to search for the refund.

        If your request is successful, the gateway removes the refund from the merchant’s open batch, and no funds are returned to the cardholder’s account.

        Parameters
        ----------
        refund_id : str
            Unique identifier that our gateway assigned to the refund.

        idempotency_key : str
            Unique identifier that you generate for each request. You must use the [UUID v4 format](https://www.rfc-editor.org/rfc/rfc4122) for the identifier. For more information about the idempotency key, go to [Idempotency](https://docs.payroc.com/api/idempotency).

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        BankTransferRefund
            Successful request. We reversed the refund transaction.

        Examples
        --------
        import asyncio

        from payroc import AsyncPayroc

        client = AsyncPayroc(
            client_id="YOUR_CLIENT_ID",
            client_secret="YOUR_CLIENT_SECRET",
        )


        async def main() -> None:
            await client.bank_transfer_payments.refunds.reverse_refund(
                refund_id="CD3HN88U9F",
                idempotency_key="8e03978e-40d5-43e8-bc93-6894a57f9324",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.reverse_refund(
            refund_id, idempotency_key=idempotency_key, request_options=request_options
        )
        return _response.data
